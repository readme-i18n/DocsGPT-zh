---

title: DocsGPT 设置
description: 通过了解基础配置来调整您的 DocsGPT 应用程序。
---

# DocsGPT 设置

DocsGPT 具有高度可配置性，您可以根据具体需求和偏好进行定制。从选择大语言模型(LLM)供应商到配置嵌入模型与向量存储，您可以控制应用的各个方面。

本文档将指导您完成 DocsGPT 的基础配置选项。这些设置决定了 DocsGPT 如何与 LLM 交互并处理您的数据。

## 配置方式

主要有两种配置 DocsGPT 设置的方法：

### 1. 通过 `.env` 文件配置（推荐）

最简单且推荐的基础配置方式是使用 `.env` 文件。该文件应位于 DocsGPT 项目的**根目录**下（与 `setup.sh` 同级的目录）。

**`.env` 文件示例结构：**

```
LLM_PROVIDER=openai
API_KEY=YOUR_OPENAI_API_KEY
LLM_NAME=gpt-4o
```

### 2. 通过 `settings.py` 文件配置（高级）

如需进行更高级的配置，或希望直接在代码中管理设置，您可以修改 `settings.py` 文件。该文件位于 DocsGPT 项目的 `application/core` 目录下。

虽然修改 `settings.py` 提供了更高的灵活性，但通常建议将基础配置放在 `.env` 文件中，而将 `settings.py` 保留用于更复杂的调整或需要通过编程方式配置参数的场景。

**`settings.py` 文件位置:** `application/core/settings.py`

## 基础配置说明

以下是最可能需要配置的一些基础参数：

- **`LLM_PROVIDER`**: 该配置决定 DocsGPT 使用哪家大型语言模型(LLM)提供商。它指示 DocsGPT 应与哪个 API 进行交互。

  - **常用取值:**
    - `docsgpt`: 使用 DocsGPT 公共 API 端点(简单免费，如 `setup.sh` 选项1提供)。
    - `openai`: 使用 OpenAI 的 API(需提供 API 密钥)。
    - `google`: 使用 Google 的 Vertex AI 或 Gemini 模型。
    - `anthropic`: 使用 Anthropic 的 Claude 模型。
    - `groq`: 使用 Groq 的模型。
    - `huggingface`: 使用 HuggingFace 推理 API。
    - `azure_openai`: 使用 Azure OpenAI 服务。
    - `openai`(当使用 Ollama、Llama.cpp、TGI 等本地推理引擎时): 该配置让 DocsGPT 使用 OpenAI 兼容的 API 格式，即使实际运行的 LLM 是本地部署的。

- **`LLM_NAME`**: 指定所选 LLM 提供商的具体模型名称。可用模型取决于您选择的 `LLM_PROVIDER`。

  - **示例:**
    - 当 `LLM_PROVIDER=openai` 时: `gpt-4o`
    - 当 `LLM_PROVIDER=google` 时: `gemini-2.0-flash`
    - 对于本地模型(如 Ollama): `llama3.2:1b`(或您本地环境中可用的任意模型名称)。

- **`EMBEDDINGS_NAME`**: 该配置定义 DocsGPT 将使用哪个嵌入模型来为文档生成向量嵌入。嵌入是对文本的数值化表示，使 DocsGPT 能理解文档的语义含义以实现高效搜索和检索。

  - **默认值:** `huggingface_sentence-transformers/all-mpnet-base-v2`(一个优秀的通用嵌入模型)。
  - **其他选项:** 如需使用，可探索 Hugging Face Sentence Transformers 或其他提供商的其他嵌入模型。

- **`API_KEY`**: 大多数云端 LLM 提供商需要此配置。这是访问 LLM 提供商 API 的身份验证密钥，需从所选提供商的平台获取。

- **`OPENAI_BASE_URL`**: 当 `LLM_PROVIDER` 设为 `openai` 但连接的是本地推理引擎(如 Ollama、Llama.cpp 等)且该引擎暴露了 OpenAI 兼容的 API 时专用。该配置告知 DocsGPT 本地 LLM 服务器的位置。

## 配置示例

让我们通过具体示例来看看如何在 `.env` 文件中配置这些设置。

### 云 API 服务商示例 (OpenAI)

要使用 OpenAI 的 `gpt-4o` 模型，你的 `.env` 文件应配置如下：

```
LLM_PROVIDER=openai
API_KEY=YOUR_OPENAI_API_KEY  # Replace with your actual OpenAI API key
LLM_NAME=gpt-4o
```

请确保将 `YOUR_OPENAI_API_KEY` 替换为实际的 OpenAI API 密钥。

### 本地部署示例

若要在本地 Ollama 服务器上使用 `llama3.2:1b` 模型，你的 `.env` 文件应配置如下：

```
LLM_PROVIDER=openai # Using OpenAI compatible API format for local models
API_KEY=None      # API Key is not needed for local Ollama
LLM_NAME=llama3.2:1b
OPENAI_BASE_URL=http://host.docker.internal:11434/v1 # Default Ollama API URL within Docker
EMBEDDINGS_NAME=huggingface_sentence-transformers/all-mpnet-base-v2 # You can also run embeddings locally if needed
```

这种情况下，虽然使用本地 Ollama 服务，但 `LLM_PROVIDER` 仍需设置为 `openai`，因为 Ollama（以及许多其他本地推理引擎）设计为与 OpenAI API 兼容。`OPENAI_BASE_URL` 将引导 DocsGPT 连接至本地 Ollama 服务器。

## 认证设置

DocsGPT 内置基于 JWT (JSON Web Token) 的认证功能，可用于管理会话或在允许访问的同时保护本地部署。

### `AUTH_TYPE` 概览

在 `.env` 文件或 `settings.py` 中配置的 `AUTH_TYPE` 决定了 DocsGPT 使用的认证方式，通过该设置可控制用户如何访问你的 DocsGPT 实例。

| 值            | 描述                                                                                     |
| ------------- | --------------------------------------------------------------------------------------- |
| `None`        | 不使用任何认证机制。任何人都可以访问应用。                                               |
| `simple_jwt`  | 在启动时生成一个长期有效的JWT令牌。所有请求都使用这个共享令牌。                          |
| `session_jwt` | 为每个会话/用户生成唯一的JWT令牌。                                                       |

#### 配置方法

在 `.env` 文件中添加以下配置（或在 `settings.py` 中设置）：

```env
# No authentication (default)
AUTH_TYPE=None

# OR: Simple JWT (shared token)
AUTH_TYPE=simple_jwt
JWT_SECRET_KEY=your_secret_key_here

# OR: Session JWT (per-user/session tokens)
AUTH_TYPE=session_jwt
JWT_SECRET_KEY=your_secret_key_here
```

- 若 `AUTH_TYPE` 设为 `simple_jwt` 或 `session_jwt`，则必须配置 `JWT_SECRET_KEY`。
- 若未设置 `JWT_SECRET_KEY`，DocsGPT 会自动生成并存储在项目根目录的 `.jwt_secret_key` 文件中。

#### 各认证方式工作原理

- **None**: 无认证。所有API和UI访问完全开放。
- **simple_jwt**:
  - 启动时生成单一JWT令牌并输出到控制台。
  - 在所有API请求的 `Authorization` 头部使用该令牌：
    ```http
    Authorization: Bearer <SIMPLE_JWT_TOKEN>
    ```
  - 前端会在未设置令牌时提示输入。
- **session_jwt**:
  - 客户端可从 `/api/generate_token` 端点请求新令牌。
  - 在后续请求的 `Authorization` 头部使用获取的令牌。
  - 每个用户/会话都会获得唯一令牌。

#### 安全注意事项

- 始终确保 `JWT_SECRET_KEY` 的安全性和私密性
- 如需手动设置，请使用高强度随机字符串
- 若未设置，DocsGPT 将自动生成安全密钥并存储于 `.jwt_secret_key` 文件中

#### 检查当前认证类型

- 通过 `/api/config` 接口可查询当前 `auth_type` 配置及是否启用认证

#### 前端令牌输入（simple_jwt 模式）

当配置 `AUTH_TYPE=simple_jwt` 时，若未设置或令牌无效，DocsGPT 前端将提示输入 JWT 令牌。请将后端启动时控制台输出的 `SIMPLE_JWT_TOKEN` 粘贴至该字段以访问应用。

<img
  src="/jwt-input.png"
  alt="Frontend prompt for JWT Token"
  style={{
    width: "500px",
    maxWidth: "100%",
    display: "block",
    margin: "1em auto",
  }}
/>

## 探索更多设置

以上仅为基础配置，`settings.py` 文件中还包含众多高级选项可供定制：

- 向量存储配置（`VECTOR_STORE`、Qdrant、Milvus、LanceDB 相关设置）
- 检索器设置（`RETRIEVERS_ENABLED`）
- 缓存配置（`CACHE_REDIS_URL`）
- 以及其他多项功能！

完整配置项及其说明请参阅 `application/core` 目录下的 `settings.py` 文件。请注意修改 `.env` 或 `settings.py` 后需重启 Docker 容器使变更生效。